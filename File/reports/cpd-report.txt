Found a 13 line (125 tokens) duplication in the following files: 
Starting at line 55 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 59 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java

						 .withExpiresAt(new Date(System.currentTimeMillis()+10*60*1000))
						 .withIssuer(request.getRequestURL().toString())
						 .withClaim("roles", user.getAuthorities().stream().map(GrantedAuthority::getAuthority).collect(Collectors.toList()))
						 .sign(alg);
				
				response.setHeader("access_token", access_token);
				response.setHeader("refresh_token", refresh_token);
				Map<String, String> tokens = new HashMap<>();
				tokens.put("access_token", access_token);
				tokens.put("refresh_token", refresh_token);
				response.setContentType(MediaType.APPLICATION_JSON_VALUE);
				new ObjectMapper().writeValue(response.getOutputStream(), tokens);
			}
=====================================================================
Found a 8 line (86 tokens) duplication in the following files: 
Starting at line 51 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 49 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java

				UserDetails user = this.customUserDetailsService.loadUserByUsername(username);
				
				String access_token = JWT.create()
						 .withSubject(user.getUsername())
						 .withExpiresAt(new Date(System.currentTimeMillis()+10*60*1000))
						 .withIssuer(request.getRequestURL().toString())
						 .withClaim("roles", user.getAuthorities().stream().map(GrantedAuthority::getAuthority).collect(Collectors.toList()))
						 .sign(alg);
=====================================================================
Found a 13 line (79 tokens) duplication in the following files: 
Starting at line 66 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 51 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthorizationFilter.java

				new ObjectMapper().writeValue(response.getOutputStream(), tokens);
			}
			catch(Exception exception) {
				response.setHeader("error", exception.getMessage());
				//response.sendError(403);
				response.setStatus(403);
				Map<String, String> error = new HashMap<>();
				error.put("error_msg", exception.getMessage());
				response.setContentType(MediaType.APPLICATION_JSON_VALUE);
				new ObjectMapper().writeValue(response.getOutputStream(), error);
			}
		}
		else {
=====================================================================
Found a 10 line (70 tokens) duplication in the following files: 
Starting at line 35 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/UserRestController.java
Starting at line 57 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/UserRestController.java

				List<String> roles = secUser.getAuthorities()
											.stream()
												.map(authority -> authority.getAuthority())
												.collect(Collectors.toList());
				AuthenticatedUser authenticatedUser = new AuthenticatedUser(username, roles);
				return new ResponseEntity<>(authenticatedUser,HttpStatus.OK); 
			}
		}
		return new ResponseEntity<>(HttpStatus.UNAUTHORIZED);
	}
=====================================================================
Found a 4 line (55 tokens) duplication in the following files: 
Starting at line 52 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java
Starting at line 59 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java

								 .withExpiresAt(new Date(System.currentTimeMillis()+10*60*1000))
								 .withIssuer(request.getRequestURL().toString())
								 .withClaim("roles", user.getAuthorities().stream().map(GrantedAuthority::getAuthority).collect(Collectors.toList()))
								 .sign(alg);
=====================================================================
Found a 17 line (47 tokens) duplication in the following files: 
Starting at line 23 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/domain/Role.java
Starting at line 30 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/domain/User.java

	public Integer getId(){
		return id;
	}

	public void setId(Integer id) {
		this.id = id;
	}

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public List<User> getUsers() {
=====================================================================
Found a 7 line (47 tokens) duplication in the following files: 
Starting at line 26 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/UserRestController.java
Starting at line 50 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/UserRestController.java

	public ResponseEntity<AuthenticatedUser> getAuthenticatedUser() {
		Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
		if(authentication!= null) {
			Object userDetails = authentication.getPrincipal();
			if(userDetails != null && userDetails instanceof UserDetails)
			{
				UserDetails secUser = (UserDetails) userDetails;
=====================================================================
Found a 4 line (44 tokens) duplication in the following files: 
Starting at line 46 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 41 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthorizationFilter.java

				String refresh_token = authHeader.substring("Bearer ".length());
				Algorithm alg = Algorithm.HMAC256(sysKey.getBytes());
				JWTVerifier verifier = JWT.require(alg).build();
				DecodedJWT decoded = verifier.verify(refresh_token);
=====================================================================
Found a 5 line (27 tokens) duplication in the following files: 
Starting at line 42 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 37 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthorizationFilter.java

	public void refreshToken(HttpServletRequest request, HttpServletResponse response) throws StreamWriteException, DatabindException, IOException{
		String authHeader = request.getHeader(AUTHORIZATION);
		if(authHeader != null && authHeader.startsWith("Bearer ")) {
			try {
				String refresh_token = authHeader.substring("Bearer ".length());
=====================================================================
Found a 3 line (27 tokens) duplication in the following files: 
Starting at line 53 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/endpoints/RefreshController.java
Starting at line 50 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java
Starting at line 57 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/security/CustomAuthenticationFilter.java

				String access_token = JWT.create()
						 .withSubject(user.getUsername())
						 .withExpiresAt(new Date(System.currentTimeMillis()+10*60*1000))
=====================================================================
Found a 9 line (25 tokens) duplication in the following files: 
Starting at line 31 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/domain/Post.java
Starting at line 23 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/domain/Role.java
Starting at line 30 of /home/dagarcos/git/DBCDSecurityBoletin/src/main/java/es/uv/garcosda/domain/User.java

	public Integer getId() {
		return id;
	}

	public void setId(Integer id) {
		this.id = id;
	}

	public String getTitle() {
